<%- include("../partials/header") %>

<div class="row justify-content-center">
  <div class="col-md-6">
    <h2 class="mb-4">Create Your Account</h2>

    <form action="/register" method="POST">
      <div class="mb-3">
        <label class="form-label">Username</label>
        <input type="text" name="username" class="form-control" placeholder="Choose a username" required />
      </div>


      <div class="mb-3">
        <label for="mobile" class="form-label">Mobile Number</label>
        <input type="text" name="mobile" class="form-control" pattern="\d{10}" maxlength="10" placeholder="10-digit mobile number" required />
      </div>

     <div class="mb-3">
        <label class="form-label">Aadhaar Number</label>
        <input type="text" id="aadhaar" name="aadhaar" class="form-control" maxlength="12" required>
        <small id="aadhaarMsg"></small>
        </div>

      <div class="mb-3">
        <label for="password" class="form-label">Password</label>
        <input type="password" name="password" class="form-control" placeholder="Choose a password" required />
      </div>

      <div class="mb-3">
        <label class="form-label">Role</label>
        <select name="role" id="role" class="form-select" required>
          <option value="citizen" selected>Citizen</option>
          <option value="admin">Admin</option>
        </select>
      </div>

      <!-- Hidden admin ID field -->
      <div class="mb-3" id="adminIdField" style="display:none;">
        <label class="form-label">Admin ID</label>
        <input type="text" name="adminCode" class="form-control" placeholder="Enter Admin ID" />
      </div>


      <button type="submit" class="btn btn-primary w-100">Sign Up</button>
    </form>

    <p class="mt-3">Already have an account? <a href="/login">Log In</a></p>
  </div>
</div>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const roleSelect = document.getElementById("role");
    const adminField = document.getElementById("adminIdField");

    roleSelect.addEventListener("change", function () {
      if (this.value === "admin") {
        adminField.style.display = "block";
      } else {
        adminField.style.display = "none";
      }
    });
  });

// function validateAadhaar(a) {
//   if (!/^[2-9]\d{11}$/.test(a)) return false;   // must be 12 digits, starting 2–9
//   if (/^(\d)\1+$/.test(a)) return false;        // reject repeated digits (111..., 000...)
//   const d=[[0,1,2,3,4,5,6,7,8,9],[1,2,3,4,0,6,7,8,9,5],[2,3,4,0,1,7,8,9,5,6],
//            [3,4,0,1,2,8,9,5,6,7],[4,0,1,2,3,9,5,6,7,8],[5,9,8,7,6,0,4,3,2,1],
//            [6,5,9,8,7,1,0,4,3,2],[7,6,5,9,8,2,1,0,4,3],[8,7,6,5,9,3,2,1,0,4],
//            [9,8,7,6,5,4,3,2,1,0]],
//         p=[[0,1,2,3,4,5,6,7,8,9],[1,5,7,6,2,8,3,0,9,4],[5,8,0,3,7,9,6,1,4,2],
//            [8,9,1,6,0,4,3,5,2,7],[9,4,5,3,1,2,6,8,7,0],[4,2,8,6,5,7,9,3,0,1],
//            [2,7,9,3,8,0,4,6,1,5],[7,0,4,6,9,1,3,2,5,8]];
//   let c=0;
//   for (let i=0;i<a.length;i++) c=d[c][p[i%8][+a[a.length-1-i]]];
//   return c===0;
// }
function validateAadhaar(a) {
  // Must be 12 digits, starting from 2–9
  if (!/^[2-9]\d{11}$/.test(a)) return false;

  // Reject if all digits same (e.g., 000000000000 or 111111111111)
  if (/^(\d)\1+$/.test(a)) return false;

  return true; // ✅ Demo-friendly, no checksum
}


document.getElementById("aadhaar").addEventListener("input", function() {
  const msg = document.getElementById("aadhaarMsg");
  if (this.value.length === 12) {
    const valid = validateAadhaar(this.value);
    msg.textContent = valid ? "✅ Valid Aadhaar" : "❌ Invalid Aadhaar";
    msg.className = valid ? "text-success fw-bold" : "text-danger fw-bold";
  } else {
    msg.textContent = "";
    msg.className = "";
  }
});


</script>

<%- include("../partials/footer") %>
